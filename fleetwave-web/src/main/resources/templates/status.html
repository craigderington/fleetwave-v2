<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">
<head>
  <title layout:fragment="head">System Status</title>
</head>
<body>
  <div layout:fragment="content">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        <div class="d-flex align-items-center mb-4">
          <i class="bi bi-heartbeat text-primary me-3" style="font-size: 3rem;"></i>
          <div>
            <h1 class="mb-1">System Status</h1>
            <p class="text-muted mb-0">FleetWave Application Health Monitor</p>
          </div>
        </div>

        <!-- Overall Health Status Card -->
        <div class="card mb-4">
          <div class="card-header bg-white">
            <h5 class="mb-0">
              <i class="bi bi-shield-check me-2"></i>Overall Health
            </h5>
          </div>
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between">
              <div>
                <h2 class="mb-0">
                  <span th:class="'badge bg-' + ${statusClass}" th:text="${healthStatus}">UP</span>
                </h2>
                <p class="text-muted small mb-0 mt-2">
                  <i class="bi bi-clock me-1"></i>
                  Last checked: <span th:text="${currentTime}">2025-10-29 12:00:00 EDT</span>
                </p>
              </div>
              <div>
                <i th:class="'bi bi-' + (${healthStatus == 'UP'} ? 'check-circle-fill text-success' : 'x-circle-fill text-danger')" style="font-size: 4rem;"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Application Info Card -->
        <div class="card mb-4">
          <div class="card-header bg-white">
            <h5 class="mb-0">
              <i class="bi bi-info-circle me-2"></i>Application Information
            </h5>
          </div>
          <div class="card-body">
            <table class="table table-borderless mb-0">
              <tbody>
                <tr>
                  <td class="text-muted" style="width: 40%;"><i class="bi bi-app me-2"></i>Application Name</td>
                  <td><strong th:text="${appName}">FleetWave</strong></td>
                </tr>
                <tr>
                  <td class="text-muted"><i class="bi bi-tag me-2"></i>Version</td>
                  <td><code th:text="${appVersion}">0.4.0-SNAPSHOT</code></td>
                </tr>
                <tr>
                  <td class="text-muted"><i class="bi bi-hdd me-2"></i>Platform</td>
                  <td>Spring Boot 3.3.x / Java 21</td>
                </tr>
                <tr>
                  <td class="text-muted"><i class="bi bi-diagram-3 me-2"></i>Architecture</td>
                  <td>Multi-tenant (shared schema)</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Component Health Details (if available) -->
        <div th:if="${healthDetails != null}" class="card mb-4">
          <div class="card-header bg-white">
            <h5 class="mb-0">
              <i class="bi bi-puzzle me-2"></i>Component Health
            </h5>
          </div>
          <div class="card-body">
            <div class="list-group list-group-flush">
              <!-- Database component -->
              <div th:if="${healthDetails['db'] != null}" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <i class="bi bi-database me-2 text-primary"></i>
                  <strong>Database</strong>
                  <span th:if="${healthDetails['db'].details['database'] != null}" class="text-muted small ms-2">
                    (<span th:text="${healthDetails['db'].details['database']}">PostgreSQL</span>)
                  </span>
                </div>
                <span th:class="'badge bg-' + (${healthDetails['db'].status.code == 'UP'} ? 'success' : 'danger')"
                      th:text="${healthDetails['db'].status.code}">UP</span>
              </div>

              <!-- Disk space component -->
              <div th:if="${healthDetails['diskSpace'] != null}" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <i class="bi bi-hdd me-2 text-primary"></i>
                  <strong>Disk Space</strong>
                  <span th:if="${healthDetails['diskSpace'].details['free'] != null}" class="text-muted small ms-2">
                    (Free: <span th:text="${#numbers.formatInteger(healthDetails['diskSpace'].details['free'] / 1024 / 1024 / 1024, 0)}">0</span> GB)
                  </span>
                </div>
                <span th:class="'badge bg-' + (${healthDetails['diskSpace'].status.code == 'UP'} ? 'success' : 'danger')"
                      th:text="${healthDetails['diskSpace'].status.code}">UP</span>
              </div>

              <!-- Ping component -->
              <div th:if="${healthDetails['ping'] != null}" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <i class="bi bi-activity me-2 text-primary"></i>
                  <strong>Application Ping</strong>
                </div>
                <span th:class="'badge bg-' + (${healthDetails['ping'].status.code == 'UP'} ? 'success' : 'danger')"
                      th:text="${healthDetails['ping'].status.code}">UP</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Links Card -->
        <div class="card">
          <div class="card-header bg-white">
            <h5 class="mb-0">
              <i class="bi bi-link-45deg me-2"></i>Quick Links
            </h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-md-6">
                <a th:href="@{/actuator/health}" class="btn btn-outline-primary w-100" target="_blank">
                  <i class="bi bi-heart-pulse me-2"></i>Health Endpoint (JSON)
                </a>
              </div>
              <div class="col-md-6">
                <a th:href="@{/actuator}" class="btn btn-outline-primary w-100" target="_blank">
                  <i class="bi bi-gear me-2"></i>All Actuator Endpoints
                </a>
              </div>
              <div class="col-md-6">
                <a th:href="@{/swagger-ui.html}" class="btn btn-outline-secondary w-100" target="_blank">
                  <i class="bi bi-file-code me-2"></i>API Documentation
                </a>
              </div>
              <div class="col-md-6">
                <a th:href="@{/}" class="btn btn-outline-secondary w-100">
                  <i class="bi bi-house me-2"></i>Back to Home
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Info Alert -->
        <div class="alert alert-info mt-4" role="alert">
          <i class="bi bi-info-circle-fill me-2"></i>
          <strong>Note:</strong> This page shows real-time health information from Spring Boot Actuator.
          Component details are only visible when the application is fully initialized.
        </div>
      </div>
    </div>
  </div>
</body>
</html>
